<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/TargetPlatform.md at 2024-01-28
 | Rendered using Apache Maven Fluido Skin 1.11.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>Tycho &#x2013; Target platform</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.11.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.11.1.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>Tycho</h1>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2024-01-28<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 5.0.0-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Tycho</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="StructuredBuild.html" title="Structured Build Layout and Pomless Builds"><span class="none"></span>Structured Build Layout and Pomless Builds</a></li>
    <li><a href="BndBuild.html" title="BND Workspace and Pomless Builds"><span class="none"></span>BND Workspace and Pomless Builds</a></li>
    <li><a href="PackagingTypes.html" title="Packaging Types"><span class="none"></span>Packaging Types</a></li>
    <li class="active"><a><span class="none"></span>Target Platform</a></li>
    <li><a href="TestingBundles.html" title="Testing Bundles"><span class="none"></span>Testing Bundles</a></li>
    <li><a href="TychoCiFriendly.html" title="Tycho CI Friendly Versions"><span class="none"></span>Tycho CI Friendly Versions</a></li>
    <li><a href="Category.html" title="Creating update sites using category.xml"><span class="none"></span>Creating update sites using category.xml</a></li>
    <li><a href="target-platform-configuration/plugin-info.html" title="Target Platform Configuration"><span class="none"></span>Target Platform Configuration</a></li>
    <li><a href="tycho-compiler-plugin/plugin-info.html" title="Compiler Plugin"><span class="none"></span>Compiler Plugin</a></li>
    <li><a href="tycho-ds-plugin/plugin-info.html" title="Declarative Services Plugin"><span class="none"></span>Declarative Services Plugin</a></li>
    <li><a href="tycho-packaging-plugin/plugin-info.html" title="Packaging Plugin"><span class="none"></span>Packaging Plugin</a></li>
    <li><a href="tycho-surefire-plugin/plugin-info.html" title="Surefire Plugin"><span class="none"></span>Surefire Plugin</a></li>
    <li><a href="tycho-p2-publisher-plugin/plugin-info.html" title="p2 Publisher Plugin"><span class="none"></span>p2 Publisher Plugin</a></li>
    <li><a href="tycho-p2-repository-plugin/plugin-info.html" title="p2 Repository Plugin"><span class="none"></span>p2 Repository Plugin</a></li>
    <li><a href="tycho-p2-director-plugin/plugin-info.html" title="p2 Director Plugin"><span class="none"></span>p2 Director Plugin</a></li>
    <li><a href="tycho-p2-plugin/plugin-info.html" title="p2 Metadata Plugin"><span class="none"></span>p2 Metadata Plugin</a></li>
    <li><a href="tycho-source-plugin/plugin-info.html" title="Source Plugin"><span class="none"></span>Source Plugin</a></li>
    <li><a href="tycho-gpg-plugin/plugin-info.html" title="GPG Signature Plugin"><span class="none"></span>GPG Signature Plugin</a></li>
    <li><a href="tycho-versions-plugin/plugin-info.html" title="Versions Plugin"><span class="none"></span>Versions Plugin</a></li>
    <li><a href="" title="Properties"><span class="icon-chevron-down"></span>Properties</a>
     <ul class="nav nav-list">
      <li><a href="BuildProperties.html" title="Build Properties"><span class="none"></span>Build Properties</a></li>
      <li><a href="SystemProperties.html" title="System Properties"><span class="none"></span>System Properties</a></li>
      <li><a href="TychoProperties.html" title="Tycho Properties"><span class="none"></span>Tycho Properties</a></li>
     </ul></li>
   <li class="nav-header">Tycho Extras</li>
    <li><a href="tycho-extras/index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="tycho-extras/tycho-p2-extras-plugin/plugin-info.html" title="P2 Extras Plugin"><span class="none"></span>P2 Extras Plugin</a></li>
    <li><a href="tycho-extras/target-platform-validation-plugin/plugin-info.html" title="Target Platform Validation Plugin"><span class="none"></span>Target Platform Validation Plugin</a></li>
    <li><a href="tycho-extras/tycho-eclipserun-plugin/plugin-info.html" title="Eclipserun Plugin"><span class="none"></span>Eclipserun Plugin</a></li>
    <li><a href="tycho-extras/tycho-document-bundle-plugin/plugin-info.html" title="Document Bundle Plugin"><span class="none"></span>Document Bundle Plugin</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>Target platform</h1>
<p>The target platform is the set of artifacts from which Tycho resolves the project's dependencies.</p>
<p>Background: OSGi allows to specify dependencies with version ranges and package dependencies (Import-Package).
These dependencies (intentionally) do not map to unique artifacts.
In order to pick a set of concrete bundles to be used for compilation, test execution, and assembly, Tycho needs a set of candidate artifacts which may be used to match the dependencies.
This list of candidate artifacts is called the &#x201c;target platform&#x201d;.
The process of selecting artifacts from the target platform according to the projects dependencies is called &#x201c;dependency resolution&#x201d;.</p>
<p>There are different ways to define the content of the target platform; the most common is the usage of target definition files for more fine-grained control or the usage of repositories with layout=p2 in the POM, which add entire p2 repositories to the target platform.</p><section>
<h2><a name="Which_approach_shall_I_use_for_the_target_platform_of_my_project.3F"></a>Which approach shall I use for the target platform of my project?</h2>
<p>There are a few different ways to configure a target platform in Tycho.
These rules of thumb should help you to pick the right approach for your project:</p>
<ul>

<li>Prefer using a target definition file in Eclipse and Tycho to share the same target platform configuration between Tycho and Eclipse. This also gives you fine-grained control of the used artifacts and speeds up the build because fewer bundles in the target platform lead to a faster download and dependency resolution.</li>
<li>If you want to get your Tycho build up and running quickly, just configure the needed p2 repositories in the POM and have Tycho pick anything required from these repositories. A good starting point should be to add one of the Simultaneous Release repositories.</li>
</ul></section><section>
<h2><a name="Target_platform_configuration"></a>Target platform configuration</h2>
<p>The target platform is defined through POM configuration (see details below).
Each module can have its own target platform, although with the normal configuration inheritance in Maven, the target platform configurations are usually the same across multiple modules.</p><section>
<h3><a name="Simple_target_platform_configuration"></a>Simple target platform configuration</h3>
<p>In order allow Tycho to resolve the project dependencies against anything from a specific p2 repository, add that repository in the <code>&lt;repositories&gt;</code> section of the POM.</p>
<p>Example:</p>

<div class="source"><pre class="prettyprint"><code>&lt;repository&gt;
   &lt;id&gt;eclipse-indigo&lt;/id&gt;
   &lt;url&gt;http://download.eclipse.org/releases/2023-12&lt;/url&gt;
   &lt;layout&gt;p2&lt;/layout&gt;
&lt;/repository&gt;
</code></pre></div>
<p>In terms of the target platform, this means that the entire content of the specified p2 repositories become part of the target platform.</p>
<p>Background: In a normal (i.e. non-Tycho) Maven project, one can configure Maven repositories which can be used by Maven to resolve the project dependencies.
Tycho can use p2 repositories for resolving OSGi dependencies.
The p2 repositories need to be marked with layout=p2. (The normal Maven dependency resolution ignores repositories with layout=p2.)</p></section><section>
<h3><a name="Target_files"></a>Target files</h3>
<p>The PDE target definition file format (*.target) allows to select a subset of units (bundles, features, etc.).</p>
<p>In order to add the content of a target definition file (see &#x201c;Content&#x201d; tab of the Target Editor) to the target platform in the Tycho build, place the target file in a eclipse-target-definition module and configure it in the target-platform-configuration build plugin. Example:</p>

<div class="source"><pre class="prettyprint"><code>&lt;plugin&gt;
   &lt;groupId&gt;org.eclipse.tycho&lt;/groupId&gt;
   &lt;artifactId&gt;target-platform-configuration&lt;/artifactId&gt;
   &lt;version&gt;${tycho-version}&lt;/version&gt;
   &lt;configuration&gt;
      &lt;target&gt;
         &lt;artifact&gt;
            &lt;groupId&gt;org.example&lt;/groupId&gt;
            &lt;artifactId&gt;target-definition&lt;/artifactId&gt;
            &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
         &lt;/artifact&gt;
      &lt;/target&gt;
   &lt;/configuration&gt;
&lt;/plugin&gt;
</code></pre></div>
<p>Since Tycho 0.17.0, it is also possible to configure multiple target files by specifying more than one <code>&lt;artifact&gt;</code> reference. Tycho interprets these target files independently and in the same way as in Eclipse: Each of the configured target files need to resolve successfully when opened in the Eclipse Target Editor. Note that the use of this Tycho feature is limited because the Eclipse PDE currently does not support activating more than one target file at once (see bug 392652).</p>
<p>Note: Tycho's interpretation of the target definition file format differs from the PDE in the following aspects:</p>
<p>The selection on the Content tab of the Target Editor is ignored.
See below for an alternative way to remove individual bundles from the target platform.
The option &#x201c;Include source if available&#x201d; is considered only if target-platform-configuration parameter targetDefinitionIncludeSource is set to honor (default value).
If targetDefinitionIncludeSource is set to force then available sources are always included and if set to ignore then available sources are always ignored.</p></section><section>
<h3><a name="Extra_requirements"></a>Extra requirements</h3>
<p>See <a class="externalLink" href="https://ci.eclipse.org/tycho/job/tycho-sitedocs/lastSuccessfulBuild/artifact/target/staging/target-platform-configuration/target-platform-configuration-mojo.html#dependency-resolution">https://ci.eclipse.org/tycho/job/tycho-sitedocs/lastSuccessfulBuild/artifact/target/staging/target-platform-configuration/target-platform-configuration-mojo.html#dependency-resolution</a></p></section><section>
<h3><a name="POM_dependencies_consider"></a>POM dependencies consider</h3>
<p>See <a class="externalLink" href="https://www.eclipse.org/tycho/sitedocs/target-platform-configuration/target-platform-configuration-mojo.html#pomDependencies">https://www.eclipse.org/tycho/sitedocs/target-platform-configuration/target-platform-configuration-mojo.html#pomDependencies</a>.</p>
<p>For an example, see the POM of this <a class="externalLink" href="https://github.com/eclipse-tycho/tycho/tree/master/demo/itp02/build02">demo project</a>.</p></section></section><section>
<h2><a name="Effective_content_of_the_target_platform"></a>Effective content of the target platform</h2>
<p>In case multiple target platform configuration approaches are combined, the target platform contains the union of the content defined through each approach.</p>
<p>Apart from the explicitly configured content, the target platform also contains the following artifacts:</p>
<p>Other artifacts from the same reactor
Locally built artifacts in the local Maven repository
Finally, it is possible to remove artifacts again from the target platform through a filtering syntax.</p><section>
<h3><a name="Locally_built_artifacts"></a>Locally built artifacts</h3>
<p>Just like in a normal Maven build, a Tycho build can use artifacts that have been built locally and installed (e.g. with mvn clean install) into the local Maven repository.
In terms of the target platform, this means that these artifacts are implicitly added to the target platform. This is for example useful if you want to rebuild a part of a Tycho reactor, or if you want to build against a locally built, newer version of an upstream project.</p>
<p>There are the following options to disable this feature:</p>
<p>Setting the CLI option <code>-Dtycho.localArtifacts=ignore</code> excludes locally built artifacts in one build. (<code>tycho.localArtifacts=ignore</code> may also be configured in the settings.xml; in this case, the default behaviour can be temporarily re-enabled with the CLI option -Dtycho.localArtifacts=default.)
Deleting <code>~/.m2/repository/.meta/p2-local-metadata.properties</code> resets Tycho's list of locally build artifacts, and therefore these artifacts will not be added to target platforms (unless, of course, the artifacts are installed again).</p></section><section>
<h3><a name="Filtering"></a>Filtering</h3>
<p>See <a class="externalLink" href="https://ci.eclipse.org/tycho/job/tycho-sitedocs/lastSuccessfulBuild/artifact/target/staging/target-platform-configuration/target-platform-configuration-mojo.html#filters">https://ci.eclipse.org/tycho/job/tycho-sitedocs/lastSuccessfulBuild/artifact/target/staging/target-platform-configuration/target-platform-configuration-mojo.html#filters</a></p></section><section>
<h3><a name="Dependency_resolution_troubleshooting"></a>Dependency resolution troubleshooting</h3>
<p>Run mvn with the flags -Dtycho.debug.resolver=true and -X to see debug output.</p>
<p>This will debug</p>
<ul>

<li>Properties</li>
<li>Available IUs</li>
<li>JRE IUs</li>
<li>Root IUs</li>
</ul></section><section>
<h3><a name="Listing_IUs_available"></a>Listing IUs available</h3>
<p>To list all the available IUs in an Eclipse p2 repository, run:</p>

<div class="source"><pre class="prettyprint"><code>java -jar plugins/org.eclipse.equinox.launcher_1.6.600.v20231106-1826.jar -debug -consolelog -application org.eclipse.equinox.p2.director -repository https://download.eclipse.org/releases/latest/ -list
</code></pre></div>
<p>Java is used (instead of the eclipse binary) so that the console output appears in the shell.
Make sure your shell is inside the Eclipse root directory</p>
<p>You will need to replace that version number for org.eclipse.equinox.launcher with the one found inside your Eclipse installation.
You will need to replace the Eclipse repository with the one you want a list of.
This can be used to double check availability of bundle versions, and compare with what Tycho searches for.</p></section><section>
<h3><a name="Browsing_a_p2_repository"></a>Browsing a p2 repository</h3>
<p>In Eclipse, open the &#x201c;Repository Explorer&#x201d; view.
If it is not available, then please install Oomph first: <a class="externalLink" href="https://projects.eclipse.org/projects/tools.oomph/downloads">https://projects.eclipse.org/projects/tools.oomph/downloads</a></p></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2008&#x2013;2024
<a href="https://www.eclipse.org/">Eclipse Foundation</a>
</p>
        </div>
      </div>
    </footer>
<script>
	if(anchors) {
	  anchors.add();
	}
</script>
  </body>
</html>
